# 定位和z-index

position 属性指定了元素的定位类型。 position 属性的四个值：

- static
- relative
- fixed
- absolute 元素可以使用的顶部，底部，左侧和右侧属性定位。然而，这些属性无法工作，除非是先设定position属性。他们也有不同的工作方式，这取决于定位方法。

HTML文档元素除了在水平（X轴）和垂直（Y轴）方向进行布局以外，还会在第三维度Z轴进行布局，在多个元素位于同一个位置的时候，用来决定层叠关系（谁在上面，谁在下面）。

## static 定位

HTML元素的默认值，即没有定位，元素出现在正常的流中。 静态定位的元素不会受到 top, bottom, left, right影响。

## fixed 定位

元素的位置相对于浏览器窗口是固定位置。

如下代码，`.fixed`元素会定位在窗口的右上角

```css
.fixed{
  position:fixed;
  top:0px;
  right:0px;
}
```

Fixed定位使元素的位置与文档流无关，因此不占据空间。 Fixed定位的元素和其他元素重叠。

## relative 定位

相对定位元素的定位是相对其正常位置。

如下代码，`.pos-rel`元素会相对于他本应该在的位置向左移动20px

```css
.pos-rel{
  position:relative;
  left:-20px;
}
```

relative 定位可以移动的相对定位元素的内容和相互重叠的元素，它原本所占的空间不会改变。

## absolute 定位

绝对定位的元素的位置相对于最近的已定位父元素，如果元素没有已定位的父元素，那么它的位置相对于`<html>:`

如下代码，`.pos-abs`元素会相对于他的第一个已定位元素距离左边100px,上边150px

```css
.pos-abs{
  position:absolute;
  left:100px;
  top:150px;
}
```

absolute 定位使元素的位置与文档流无关，因此不占据空间。 absolute 定位的元素和其他元素重叠。



1、position: relative;不脱离文档流， 相对于自己在文档流中的原始位置进行定位

2、position: fixed; 脱离文档流，相对于浏览器窗口进行定位。

3、position: absolute; 脱离文档流，相对于父级非position:static进行定位，如果没有任何一个父级元素（任意上级元素）是非position:static属性，则会相对于文档定位。如果它的父级元素和爷爷级上级元素都是非position:static 属性，则会选择最近的父元素进行定位。



## 定位重叠的元素

元素的定位与文档流无关，所以它们可以覆盖页面上的其它元素 z-index属性指定了一个元素的堆叠顺序（哪个元素应该放在前面，或后面

### z-index属性

该属性仅适用于定位元素。即元素的`position`属性为除`static`以外的值。

`z-index`属性赋值情况有以下三种：

|     值      |                       描述                        |
| :---------: | :-----------------------------------------------: |
|   `auto`    | 默认, 会处理成`z-index=0`, 堆叠顺序与父元素相等。 |
| `<integer>` |                设置元素的堆叠顺序                 |

简单来讲，元素的层叠顺序可以根据`z-index`的值进行判断，当`z-index`的值越大则越在上层，越小越在下层。

### 属性值

- `auto`: 默认值，当前值与父级相同
- `<integer>`: 整型数字

### 基本特性

1. `z-index` 属性允许为负值。
2. `z-index` 属性支持 CSS3 `animation` 动画。
3. 在 CSS 2.1 的时候，需要配合 `position` 属性且值不为 `static` 时使用。

### 1.为什么我写的z-index没有生效？

这个很简单，因为它单独使用时不生效，一定要配合定位属性一起，即只对指定了position属性的元素生效——只要不是默认值static，其他的absolute、relative、fixed都可以使z-index生效。(在CSS3之后，弹性元素的子元素也可以生效)

- 层叠上下文的层叠水平要比普通元素高
- 层叠上下文可以嵌套，内部层叠上下文及其所有子元素均受制于外部的层叠上下文
- 每个层叠上下文不会影响它的兄弟元素，当进行层叠变化或渲染的时，只和该元素的后代元素有关
- 每个层叠上下文是独立的，当元素发生层叠的时，它的层叠顺序依赖在父层叠上下文的层叠顺序中

1、定位属性不正确：z-index 属性只对设置了定位属性（如 position: relative;、position: absolute; 或 position: fixed;）的元素生效。确保要设置 z-index 的元素具有正确的定位属性。

2、元素层级关系：z-index 属性只能在同一个层级的元素之间进行比较。如果要使一个元素位于另一个元素之上，两个元素应该是兄弟节点（即拥有同一个父元素），并且具有相应的定位属性和 z-index 值。

3、父元素的 z-index 值：父元素的 z-index 值可能会影响子元素的层叠顺序。确保父元素的 z-index 值没有覆盖子元素的 z-index 值。

4、元素被其他元素遮挡：如果一个元素被其他元素完全遮挡，那么它的 z-index 值不会生效。请检查是否有其他元素重叠或遮挡了目标元素。使用前提

z-index只能在position属性值为relative或absolute或fixed的元素上有效。

基本原理

z-index值可以控制定位元素在垂直于显示屏方向（Z 轴）上的堆叠顺序（stack order），值大的元素发生重叠时会在值小的元素上面。

使用的相对性

z-index值只决定同一父元素中的同级子元素的堆叠顺序。父元素的z-index值（如果有）为子元素定义了堆叠顺序（css版堆叠“拼爹”）。向上追溯找不到含有z-index值的父元素的情况下，则可以视为自由的z-index元素，它可以与父元素的同级兄弟定位元素或其他自由的定位元素来比较z-index的值，决定其堆叠顺序。同级元素的z-index值如果相同，则堆叠顺序由元素在文档中的先后位置决定，后出现的会在上面。

所以如果当你发现一个z-index值较大的元素被值较小的元素遮挡了，请先检查它们之间的dom结点关系，多半是因为其父结点含有激活并设置了z-index值的position定位元素。

也因为这个相对性，还会引发浏览器表现不一致出现**兼容问题**。原因是ie6、7下面position值为非static的元素在未设置z-index值的情况下都会被隐含添加z-index:0，而Firefox/Chrome等现代浏览器会遵循标准默认z-index:auto不会产生值。

还有一点需要注意，负值的z-index也依照大小比较的原理，但一般来说负值的z-index会被透明的body覆盖导致点击等事件响应出现问题，请谨慎使用。



## 问答题

1. 什么是定位？一般什么时候使用定位？

   定位：指定元素的位置，实现网页布局position 属性指定了元素的定位类型。

   当多个元素位于同一位置或元素被文档流影响其位置时，就要用定位来决定层叠关系和布局

2. `fixed` 定位 和 `absolute` 定位 有何异同之处？他们是相对什么元素定位的？

   fixed元素的位置相对于浏览器窗口是固定位置。Fixed定位使元素的位置与文档流无关，因此不占据空间。 Fixed定位的元素和其他元素重叠。

   绝对定位的元素的位置相对于最近的已定位父元素，如果元素没有已定位的父元素，那么它的位置相对于`<html>:`absolute 定位使元素的位置与文档流无关，因此不占据空间。 absolute 定位的元素和其他元素重叠。

3. `relative` 定位中的 `top`，`left`，`bottom`，`right` 属性是相对什么进行定位的

   最近的已定位的父元素

4. 对于使用定位重叠后的元素，我们希望他们按照某种顺序排布，需要使用哪个属性？

    z-index属性指定了一个元素的堆叠顺序（哪个元素应该放在前面，或后面）

## 代码题

1. 请实现 [码蜂社官网](https://www.mafengshe.com/) 导航条的固定效果

   

2. 请使用纯 css 实现 [码蜂社官网](https://www.mafengshe.com/) 标题
   ![0_1514260790229_upload-aa1ed62a-1028-4160-a3de-f42463637820](http://bbs.static.mafengshe.com/FsJDLU5tj3lxp_1M_TCuyw-GjSK-?imageMogr2/quality/40)