# 表单二

## 学习目标

- POST/GET请求
- HTML5表单新特性

## GET/POST 请求

> GET/POST 请求不同之处只在于字母不一 样？

Http定义了与服务器交互的不同方法，最基本的方法有4种，分别是GET，POST，PUT，DELETE。一个推荐的实践是使用 restful api，详细可参考[这里](http://www.ruanyifeng.com/blog/2014/05/restful_api.html) URL全称是资源描述符，我们可以这样认为：一个URL地址，它用于描述一个网络上的资源，而HTTP中的GET，POST，PUT，DELETE就对应着对这个资源的查，改，增，删4个操作。 到这里，大家应该有个大概的了解了，GET一般用于获取/查询资源信息，而POST一般用于更新资源信息。

### GET应该是安全的和幂等的

- 所谓安全的意味着该操作用于获取信息而非修改信息。换句话说，GET 请求一般不应产生副作用。就是说，它仅仅是获取资源信息，就像数据库查询一样，不会修改，增加数据，不会影响资源的状态。

- 幂等的意味着对同一URL的多个请求应该返回同样的结果。再解释一下幂等这个概念：

  ```
  幂等（idempotent、idempotence）是一个数学或计算机学概念，常见于抽象代数中。
  幂等有一下几种定义：
  对于单目运算，如果一个运算对于在范围内的所有的一个数多次进行该运算所得的结果和进行一次该运算所得的结果是一样的，那么我们就称该运算是幂等的。比如绝对值运算就是一个例子，在实数集中，有abs(a)=abs(abs(a))。
  对于双目运算，则要求当参与运算的两个值是等值的情况下，如果满足运算结果与参与运算的两个值相等，则称该运算幂等，如求两个数的最大值的函数，有在在实数集中幂等，即max(x,x) = x。
  ```

### POST表示可能改变服务器上的资源的请求

比如我们注册用户一般使用 POST 提交，因为会在服务器上添加一个用户信息。

### 如何选择？

选择 GET

- 获取服务器上的资源
- 请求中的URL可以被手动输入
- 请求中的URL可以被存在书签里，或者历史里，或者快速拨号里面，或者分享给别人。
- 请求中的URL是可以被搜索引擎收录的。
- 请求中的URL可以被缓存。

选择 POST

- 希望修改（增加）服务器上的资源
- 不希望提交的信息被在 URL 中看到
- 提交的信息比较大
- 提交的有文件，或者二进制内容

**一句话总结**

可以重复的交互，比如取个数据，跳个页面，用GET；不可以重复的操作， 比如创建一个条目， 用POST。

### POST 比 GET 安全？

> 注意，这里的安全，和上面的 GET 应该是安全的安全不是同一个安全

是的， POST要比GET安全一点点，注意，是一点点

GET的URL会被放在浏览器历史和WEB 服务器日志里面。 POST 请求发送的信息放在请求体里，发完就没有了。

## HTML5表单新特性

HTML5 为标准的 Web 表单增添了一系列新功能。

### Placeholder

上一节中已经用过，html5以前都是用javascript实现，

```html
<input name="s" placeholder="Search">
```

### Auto Focus

默认使光标聚焦于某一文本框，打开网页即可输入文本。

```html
<input name="s" autofocus>
```

### datalist

<img src="C:\Users\86153\AppData\Roaming\Typora\typora-user-images\image-20230911212758167.png" alt="image-20230911212758167" style="zoom:50%;" />

datalist 属性提供一个下拉列表，如下：

```html
<input list="cars">
<datalist id="cars">
  <option value="BMW">
  <option value="Ford">
  <option value="Volvo">
</datalist>
```

试试label属性

```html
<option label="$43K" value="BMW">
```

### Input types

HTML5新增了`input`标签的多种特性，`email`、`url`、`number`、`range`、`date`、 `time`、 `datetime`、 `month`、 `week`、`search`、`color`等，用法基本相同：

```html
<input type="email">
```

### 表单验证

#### 利用`type`进行验证

对`input`设定相应的`type`之后，会根据相应的`type`进行校验，例如`type="email"`和`type="url"`填错时会有提示效果：

![img](http://fe-base.books.mafengshe.com/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/HTML/images/type-validation.png)

#### 利用`max`/`min`进行验证

对于`<input type="number">`通过设置`min`和`max`来限制数字的合理范围，校验效果如下：

![img](http://fe-base.books.mafengshe.com/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/HTML/images/number-validation.png)

#### `pattern`属性

`pattern` 是个强大的属性，根据正则表达式来判断用户输入的合理性，例如：

```html
<form>
  <input type="text" pattern="[A-Za-z]{3}" title="Just input three letters">
  <input type="submit">
</form>
```

#### `required`属性

如果某个字段是必填的，则可以用`required`属性，如果用户没填，就会出现提醒且无法提交。

```html
<input type="text" required>
```

#### 防止自动验证

可利用`novalidate`属性使整个表单不会自动验证。

```html
<form novalidate>
  <input type="email" name="email">
  <!-- ..other stuff.. -->
</form>
```

对单个`input`防止自动验证

```html
<input type="text" formnovalidate>
```

#### 表单验证与CSS

为了配合HTML5 强大的表单验证，CSS3 中同样有几个伪类被引入，来支持对不同验证状态的表单进行选择。你可以为它们添加样式。

- `required` 和 `optional` 伪类

  所有含有`required`属性的表单元素可以被`:required`选取；其余元素可以被`:optional`选取。

- `valid` 和 `invalid` 伪类

  当一个输入框的内容被浏览器认为是「有效的」时，它就可以被`valid`伪类选取。相反，当一个输入框的内容被视为「无效的」时，既可被`invalid`伪类选取。

  - 任何不加`required`限制的空`input`总是有效的。
  - 一个输入了任何字符的`<input required>`为有效的。
  - 一个输入了合法 Email 地址的`<input type="email" required>`是有效的。
  - 一个输入数值在限定范围内的`<input type="number" min="0" max="100" required>`是有效的。等等。

- `in-range` 和 `out-of-range` 伪类

  这两个伪类主要针对含有「范围」含义的输入类型，例如`number`。

  - 数值类型不合法算作`out-of-range`。
  - 没有规定`min`和`max`也可能发生`out-of-range`（见上一种情况）。
  - 数值在`min`和`max`范围之外算作`out-of-range`。
  - 属于`out-of-range`则一定属于`invalid`，反之不成立（还需要是范围类的标签类型）。
  - 属于`in-range`则一定属于`valid`，反之也成立。 目前 Firefox 和 IE 不支持这两个伪类。

## 参考资源

- [新的表单类型、表单验证等特性介绍](https://www.renfei.org/blog/html5-introduction-4-form-types-and-validation.html)
- [精通HTML表格的使用](http://www.ruanyifeng.com/blog/2009/05/html_table_mastering.html)
- [HTML fieldset标签——表单分组](http://www.dreamdu.com/xhtml/tag_fieldset/)
- [HTML legend 标签](http://www.dreamdu.com/xhtml/tag_legend/)



### 问答题

1. 什么是 HTTP 协议？HTTP 协议常见的请求类型有哪些？

   >+ HTTP，即超文本传输协议，是一种实现客户端和服务器之间通信的响应协议，它是用作客户端和服务器之间的请求。客户端（浏览器）会向服务器提交HTTP请求；然后服务器向客户端返回响应；其中响应包含有关请求的状态信息，还可能包含请求的内容。
   >+ get、post、put、delete

2. HTTP 请求和回复的关系是什么？

   > HTTP 请求和回复是客户端和服务器之间进行通信的方式。当客户端发送一个 HTTP 请求时，它会包含一些信息，如请求方法（GET、POST等）、请求头部和请求体。服务器接收到这个请求后会根据请求的内容进行处理，并生成一个 HTTP 回复作为响应。这个响应包含了状态码、响应头部和响应体，然后服务器将这个响应发送回客户端。通过这种方式，客户端和服务器之间可以进行数据的交互和通信。

3. GET 请求一般是安全的和幂等的，请解释这句话的具体含义

   >+ 安全的：当客户端向服务器发送 "GET" 请求时，服务器不会对资源进行修改或者引起副作用，也不会产生任何状态变化。因此，"GET" 请求是安全的，因为它不会对服务器上的资源造成任何损害或修改。
   >+ 幂等的：这意味着对于同一个请求，服务器不会对资源进行多次修改。无论客户端发送多少次 "GET" 请求，服务器都会返回相同的结果，这有助于保持数据一致性和避免意外修改资源的情况。

4. POST 请求一般用于干什么？它是幂等的吗？

   >"POST" 请求通常用于向服务器提交数据，例如创建新资源、更新现有资源或执行非幂等的操作。与 "GET" 请求不同，"POST" 请求会对服务器上的资源进行修改或引起副作用，因此它具有非幂等性。
   >
   >

5. GET 和 POST 请求有什么区别？

   >+ 数据位置：GET 请求将数据附加在 URL 的查询参数中，而 POST 请求将数据包含在请求的主体中。因此，GET 请求的数据可以在 URL 中直接看到，而 POST 请求的数据则不会显示在 URL 中。   
   >+ 数据长度限制：由于 GET 请求将数据附加在 URL 中，URL 的长度有限制，因此 GET 请求的数据传输量较小。而 POST 请求将数据放在请求主体中，没有长度限制，可以传输较大量的数据。   
   >+ 安全性：GET 请求的数据暴露在 URL 中，容易被拦截或缓存，因此不适合传输敏感信息。POST 请求的数据在请求主体中，相对更安全，适合传输敏感信息。   
   >+ 幂等性：GET 请求是幂等的，多次发送相同的 GET 请求不会产生副作用。而 POST 请求是非幂等的，多次发送相同的 POST 请求可能会产生不同的结果或副作用。 
   >
   >

6. 什么时候用 GET 请求，什么时候用 POST 请求？

   ><img src="C:\Users\86153\AppData\Roaming\Typora\typora-user-images\image-20230912152126394.png" alt="image-20230912152126394" style="zoom: 67%;" />
   >
   >

7. GET 请求提交表单是如何编码的？编码后的数据放在哪里？

   > + 对于get方法来说，都是把数据串联在请求的url后面作为参数，如：http://localhost:8080/servlet?msg=abc （很常见的一个乱码问题就要出现了，如果url中出现中文或其它特殊字符的话，如：http://localhost:8080 /servlet?msg=杭州，服务器端容易得到乱码），url拼接完成后，浏览器会对url进行URL encode，然后发送给服务器，URL encode的过程就是把部分url做为字符，按照某种编码方式（如：utf-8,gbk等）编码成二进制的字节码，然后每个字节用一个包含3个字符的字符串"%xy" 表示，其中xy为该字节的两位十六进制表示形式。
   > + Get 将表单中数据的按照 variable=value 的形式，添加到 action 所指向的 URL 后面，并且两者使用 “?” 连接，而各个变量之间使用 “&” 连接

8. POST 请求提交表单是如何编码的？编码后的数据放在哪里？

   > +   在post方法里所要传送的数据也要URL encode，在form所在的html文件里如果有段 <meta http-equiv="Content-Type"content="text/html; charset=字符集（GBK，utf-8等）"/>，那么post就会用此处指定的编码方式编码。 一般大家都认为这段代码是为了让浏览器知道用什么字符集来对网页解释，所以网站都会把它放在html代码的最前端，尽量不出现乱码，其实它还有个作用就是 指定form表单的post方法提交数据的 URL encode编码方式 。从这里可以看出对于get方法来说，浏览器对数据的URL encode的编码方式是有浏览器设置来决定，（可以用js做统一指定），而post方法，开发人员可以指定。 
   > + Post 是将表单中的数据放在 form 的数据体中，按照变量和值相对应的方式，传递到 action 所指向 URL 。
   > + ![image-20230912165957283](C:\Users\86153\AppData\Roaming\Typora\typora-user-images\image-20230912165957283.png)

9. HTML5新提供的表单控件有哪些？

   > ```placeholder``` 、```autofocus```、 ```datalist```还新增了`input`标签的多种特性，`email`、`url`、`number`、`range`、`date`、 `time`、 `datetime`、 `month`、 `week`、`search`、`color`等

10. HTML5提供了哪些表单验证方法？

    > #### 利用`type`进行验证
    >
    > 对`input`设定相应的`type`之后，会根据相应的`type`进行校验，例如`type="email"`和`type="url"`填错时会有提示效果：
    >
    > ![img](http://fe-base.books.mafengshe.com/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/HTML/images/type-validation.png)
    >
    > #### 利用`max`/`min`进行验证
    >
    > 对于`<input type="number">`通过设置`min`和`max`来限制数字的合理范围，校验效果如下：
    >
    > ![img](http://fe-base.books.mafengshe.com/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/HTML/images/number-validation.png)
    >
    > #### `pattern`属性
    >
    > `pattern` 是个强大的属性，根据正则表达式来判断用户输入的合理性，例如：
    >
    > ```html
    > <form>
    >   <input type="text" pattern="[A-Za-z]{3}" title="Just input three letters">
    >   <input type="submit">
    > </form>
    > ```
    >
    > #### `required`属性
    >
    > 如果某个字段是必填的，则可以用`required`属性，如果用户没填，就会出现提醒且无法提交。
    >
    > ```html
    > <input type="text" required>
    > ```
    >
    > #### 防止自动验证
    >
    > 可利用`novalidate`属性使整个表单不会自动验证。
    >
    > ```html
    > <form novalidate>
    >   <input type="email" name="email">
    >   <!-- ..other stuff.. -->
    > </form>
    > ```
    >
    > 对单个`input`防止自动验证
    >
    > ```html
    > <input type="text" formnovalidate>
    > ```