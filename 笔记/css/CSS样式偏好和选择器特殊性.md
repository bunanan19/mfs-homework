# CSS样式偏好和选择器特殊性

## CSS样式指导

浏览器根据继承和继承规则确定显示一个元素时各种样式属性采用的值。对于每一个这种属性，浏览器都需要查看其所有样式来源。

由浏览器定义的样式称为**浏览器样式**或者称为**用户代理样式**。

用户通过浏览器应用自己的样式（如调整网页的字号和字体），称为用户**样式**。
网站开发者提供的样式（元素内嵌样式、文档内嵌样式和外部样式表）合称为**作者样式**。

最后把样式属性值标记为重要（**!important**），可以提升重要性。

因此，各方采用以下重要度阶梯（排名越前越重要）

- 标有！重要的用户风格
- 标有！重要的作者风格
- 作者风格
- 用户风格
- 浏览器/用户代理样式

## 选择器件特殊性

如果有偏置定义于同一层次的样式来衡量同一个元素，并且它们都包含着浏览器要查看的CSS属性，那么浏览器会评估偏置样式的具体程序，然后选中一些特殊的那选择
器特殊性也称为选择器优先级、选择器权重。

以下引用[MDN关于特殊性的定义](https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity)

> 特异性是根据每个选择器类型的计数应用于给定 CSS 声明的权重。在特异性相等的情况下，CSS 中找到的最新声明将应用于该元素。特异性仅适用于针对相同元素的情况。直接针对元素的 CSS 规则将始终优先于元素从祖先继承的规则。

选择器的特殊性短路4个成分等级：a、b、c和d

- 如果样式是行内样式，那么a = 1
- b 等于ID选择器的总数
- c 相等类、α类和属性选择器的数量
- d 相等元素选择器和伪元素选择器的数量
- 忽略通用选择器
- 如果规则的特殊性相同，那么后面定义两个的规则优先级

特殊性示例

| 选择器                   | 特殊性   | 以10为基数的特殊性 |
| ------------------------ | -------- | ------------------ |
| 样式=“”                  | 1,0,0,0  | 1000               |
| #包装#内容{}             | 0,2,0,0  | 200                |
| #content .datePosted {}  | 0,1,1,0  | 110                |
| div#内容{}               | 0,1,0,1  | 101                |
| ＃内容 {}                | 0,1,0,0, | 100                |
| p.comment .dateposted {} | 0,0,2,1  | 21                 |
| p.评论{}                 | 0,0,1,1  | 11                 |
| 分区 p {}                | 0,0,0,2  | 2                  |
| p{}                      | 0,0,0,1  | 1                  |

## 几种特殊情况的处理

### ID 属性选择器 *[id="foo"]

> 特异性基于选择器的形式。在以下情况下，选择器 *[id="foo"] 被视为属性选择器，以便确定选择器的特殊性，即使它选择了 ID。

按属性选择器计算，即使是通过ID属性来定位的

```
* #foo {
  color: green;
}
*[id="foo"] {
  color: blue;
}

<p id="foo">The text color is green.</p>
```



### 否定选择器 :not

> 否定伪类 :not 在特异性计算中不被视为伪类。但是在确定选择器类型的计数时，放入否定伪类的选择器将被视为普通选择器。

否定选择器不作为伪类选择器计算权限重，则否定选择器内部的选择器按正常情况处理

```
div.outer p {
  color:green;
}
div:not(.outer) p {
  color: blue;
}

<div class="outer">
  <p>The text color is green.</p>
  <div class="inner">
    <p>The text color is blue.</p>
  </div>
</div>
```



### 直接定位元素的样式比继承来的样式更特殊

> 无论继承规则的特殊性如何，直接目标元素的样式始终优先于继承的样式。

```
#parent {
  color: green;
}
h1 {
  color: blue;
}

<div id="parent">
  <h1>The text color is blue.</h1>
</div>
```



## 参考文献

- [特异性- CSS | MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/Specificity)
- [选择器级别 3](http://www.w3.org/TR/selectors/#specificity)